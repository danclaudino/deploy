<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Quantum Kernels - AIDE-QC</title><meta name=description content="Advancing Integrated Development Environments for Quantum Computing"><meta name=generator content="Hugo 0.76.5"><link href=https://aide-qc.github.io/deployindex.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://aide-qc.github.io/deploy/users/quantum_kernels/><link rel=stylesheet href=https://aide-qc.github.io/deploy/css/theme.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script><link rel=stylesheet href=https://aide-qc.github.io/deploy/css/chroma.min.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js></script><script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script><script src=https://aide-qc.github.io/deploy/js/bundle.js></script><style>:root{}</style></head><body><div class=container><header><h1><div><img src=https://aide-qc.github.io/deploy/aide_qc_logo_v3.png width=40px align=absmiddle>
AIDE-QC</div></h1><p class=description>Advancing Integrated Development Environments for Quantum Computing</p></header><div class=global-menu><nav><ul><li class=parent><a href>Community<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=https://aideqc.slack.com>AIDE-QC Slack</a></li><li class=child><a href=https://xacc-dev.slack.com>XACC/QCOR Slack</a></li></ul></li><li class=parent><a href=https://github.com/aide-qc>Source<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=https://ornl-qci.github.io/qcor-api-docs/>QCOR Doxygen</a></li><li class=child><a href=https://ornl-qci.github.io/xacc-api-docs/>XACC Doxygen</a></li><li class=child><a href=https://github.com/aide-qc/qcor>QCOR</a></li><li class=child><a href=https://github.com/aide-qc/xacc>XACC</a></li></ul></li><li><a href=https://github.com/aide-qc/aide-qc/issues>Bugs</a></li><li><a href=http://aide-qc.org>Project Page</a></li></ul></nav></div><div class=content-container><main><h1>Quantum Kernels</h1><p>The AIDE-QC stack programming model treats available QPUs (physical or virtual) as general co-processors. Programming those co-processors consists of defining what we call <em>quantum kernels</em> - standard functions (in the classical language) whose function body is made up of some quantum domain specific language (DSL), and the function is annotated appropriately to indicate that this function is <em>quantum</em>. These domain specific languages can be low-level quantum assembly representations, or high-level language constructs that the <code>qcor</code> compiler can parse and compile to appropriate instructions for the targeted backend. As of this writing, the <code>qcor</code> compiler allows quantum kernel expression using the XACC XASM and IBM OpenQasm assembly dialects, as well as a higher-level unitary matrix decomposition mechanism that lets programmers express algorithms as unitary matrices that the compiler decomposes to one and two qubit gates. We also support a Pythonic form of the XASM dialect for use in defining single-source Pythonic quantum kernels. Ultimately, quantum kernel expressions in the AIDE-QC stack will have the following form (<code>args...</code> here implies any argument types can be passed to the kernel)</p><table><tr><th>C++ Quantum Kernel Structure</th><th>Pythonic Quantum Kernel Structure</th></tr><tr><td><div class=highlight><pre class=chroma><code class=language-cpp data-lang=cpp><span class=n>__qpu__</span> <span class=kt>void</span> <span class=nf>kernel</span><span class=p>(</span><span class=n>qreg</span> <span class=n>q</span><span class=p>,</span> <span class=n>args</span><span class=p>...)</span> <span class=p>{</span>
   <span class=p>...</span> <span class=n>qDSL</span> <span class=p>...</span> 
<span class=p>}</span>
</code></pre></div></td><td><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=nd>@qjit</span>
<span class=k>def</span> <span class=nf>kernel</span><span class=p>(</span><span class=n>q</span> <span class=p>:</span> <span class=n>qreg</span><span class=p>,</span> <span class=n>args</span><span class=o>...</span><span class=p>):</span>
    <span class=o>...</span> <span class=n>Pythonic</span> <span class=n>qDSL</span> <span class=o>...</span> 
</code></pre></div></td></tr></table><p>In C++, we require users annotate quantum kernel functions with <code>__qpu__</code>. This annotations is actually a preprocessor definition that expands to <code>[[clang::syntax(qcor)]]</code> to interface the kernel with the
<a href=/deploy/developers/clang_syntax/>Clang Syntax Handler</a>
infrastructure. This ensures proper processing of the quantum DSL within the kernel function body and maps it to appropriate <code>qcor</code> runtime API calls. These kernels must take a <code>qreg</code> (quantum register) instances a function argument to operate the quantum code on. After that, kernels can take any further function arguments that parameterize the quantum computation.</p><p>In Python, we require users annotate quantum kernel functions with the <code>@qjit</code> decorator. This decorator gives us the ability to analyze the quantum kernel function body and just-in-time compile it using the <code>qcor</code>
<a href=/deploy/>QJIT</a>
infrastructure (which further delegates to the
<a href=/deploy/developers/clang_syntax/>Clang Syntax Handler</a>
and the
<a href=https://llvm.org/docs/tutorial/BuildingAJIT1.html>LLVM JIT Engine</a>
). These functions must also take a <code>qreg</code> that the kernel function body operates on, and can take any further arguments to parameterize the quantum code. However, note that in Python, programmers must provide the correct type hint for the function argument. This helps our infrastructure not have to perform argument type inference when mapping to C++ and the <code>QJIT</code> infrastructure.</p><p>The AIDE-QC programming model adheres extra functionality to quantum kernels. Specifically, given a quantum kernel, programmers should be able to produce controlled and adjoint versions of the kernel, as well as print or query structural information about the kernel. Given a kernel <code>foo</code>, one should be able to leverage <code>foo::ctrl(...)</code> in C++, or <code>foo.ctrl(...)</code> in Python. Similarly for the <code>adjoint</code> or reverse of a kernel. Quantum kernels should also enable printing to a stream, and querying the number of instructions, depth, etc. Here is an example of using <code>ctrl</code>, <code>adoint</code>, and other kernel query functions:</p><table><tr><th>C++ Extra Kernel Functionality</th><th>Pythonic Quantum Kernel Structure</th></tr><tr><td><div class=highlight><pre class=chroma><code class=language-cpp data-lang=cpp><span class=n>__qpu__</span> <span class=kt>void</span> <span class=nf>oracle</span><span class=p>(</span><span class=n>qreg</span> <span class=n>q</span><span class=p>)</span> <span class=p>{</span>
   <span class=kt>int</span> <span class=n>bitIdx</span> <span class=o>=</span> <span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span>
   <span class=n>T</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=n>bitIdx</span><span class=p>]);</span>
<span class=p>}</span>

<span class=n>__qpu__</span> <span class=kt>void</span> <span class=nf>qpe</span><span class=p>(</span><span class=n>qreg</span> <span class=n>q</span><span class=p>)</span> <span class=p>{</span>
  <span class=p>...</span>
  <span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>bitPrecision</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=p>(</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=n>i</span><span class=p>);</span> <span class=n>j</span><span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
        <span class=n>oracle</span><span class=o>::</span><span class=n>ctrl</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>q</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>}</span>
  <span class=p>...</span>
<span class=p>}</span>
</code></pre></div></td><td><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=nd>@qjit</span>
<span class=k>def</span> <span class=nf>oracle</span><span class=p>(</span><span class=n>q</span> <span class=p>:</span> <span class=n>qreg</span><span class=p>):</span>
   <span class=n>bitIdx</span> <span class=o>=</span> <span class=n>q</span><span class=o>.</span><span class=n>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span>
   <span class=n>T</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=n>bitIdx</span><span class=p>])</span>

<span class=nd>@qjit</span>
<span class=k>def</span> <span class=nf>qpe</span><span class=p>(</span><span class=n>q</span> <span class=p>:</span> <span class=n>qreg</span><span class=p>):</span>
    <span class=o>...</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>bitPrecision</span><span class=p>):</span>
        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=n>i</span><span class=p>):</span>
            <span class=n>oracle</span><span class=o>.</span><span class=n>ctrl</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>q</span><span class=p>)</span>
    <span class=o>...</span>


</code></pre></div></td></tr><tr><td><div class=highlight><pre class=chroma><code class=language-cpp data-lang=cpp><span class=n>__qpu__</span> <span class=kt>void</span> <span class=nf>measure_all</span><span class=p>(</span><span class=n>qreg</span> <span class=n>q</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=nl>i</span> <span class=p>:</span> <span class=n>range</span><span class=p>(</span><span class=n>q</span><span class=p>.</span><span class=n>size</span><span class=p>())</span> <span class=p>{</span>
    <span class=n>Measure</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
  <span class=p>}</span>
<span class=p>}</span>

<span class=n>__qpu__</span> <span class=kt>void</span> <span class=nf>kernel</span><span class=p>(</span><span class=n>qreg</span> <span class=n>q</span><span class=p>,</span> <span class=kt>double</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>X</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
    <span class=n>Ry</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>x</span><span class=p>);</span>
    <span class=n>CX</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
<span class=p>}</span>

<span class=n>__qpu__</span> <span class=kt>void</span> <span class=nf>do_nothing</span><span class=p>(</span><span class=n>qreg</span> <span class=n>q</span><span class=p>,</span> <span class=kt>double</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>quantum_kernel</span><span class=p>(</span><span class=n>q</span><span class=p>,</span><span class=n>x</span><span class=p>);</span>
    <span class=n>quantum_kernel</span><span class=o>::</span><span class=n>adjoint</span><span class=p>(</span><span class=n>q</span><span class=p>,</span><span class=n>x</span><span class=p>);</span>
    <span class=n>measure_qbits</span><span class=p>(</span><span class=n>q</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td><td><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=nd>@qjit</span>
<span class=k>def</span> <span class=nf>measure_all</span><span class=p>(</span><span class=n>q</span> <span class=p>:</span> <span class=n>qreg</span><span class=p>):</span>
  <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>q</span><span class=o>.</span><span class=n>size</span><span class=p>()):</span>
     <span class=n>Measure</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>

<span class=nd>@qjit</span>
<span class=k>def</span> <span class=nf>kernel</span><span class=p>(</span><span class=n>q</span> <span class=p>:</span> <span class=n>qreg</span><span class=p>,</span> <span class=n>x</span> <span class=p>:</span> <span class=nb>float</span><span class=p>):</span>
    <span class=n>X</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
    <span class=n>Ry</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>x</span><span class=p>)</span>
    <span class=n>CX</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

<span class=nd>@qjit</span>
<span class=k>def</span> <span class=nf>do_nothing</span><span class=p>(</span><span class=n>q</span> <span class=p>:</span> <span class=n>qreg</span><span class=p>,</span> <span class=n>x</span> <span class=p>:</span> <span class=nb>float</span><span class=p>):</span>
    <span class=n>quantum_kernel</span><span class=p>(</span><span class=n>q</span><span class=p>,</span><span class=n>x</span><span class=p>)</span>
    <span class=n>quantum_kernel</span><span class=o>.</span><span class=n>adjoint</span><span class=p>(</span><span class=n>q</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span>
    <span class=n>measure_qbits</span><span class=p>(</span><span class=n>q</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></td></tr><tr><td><div class=highlight><pre class=chroma><code class=language-cpp data-lang=cpp><span class=n>__qpu__</span> <span class=kt>void</span> <span class=nf>kernel</span><span class=p>(</span><span class=n>qreg</span> <span class=n>q</span><span class=p>,</span> <span class=kt>double</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>X</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
    <span class=n>Ry</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>x</span><span class=p>);</span>
    <span class=n>CX</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>]);</span>
<span class=p>}</span>
<span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>auto</span> <span class=n>q</span> <span class=o>=</span> <span class=n>qalloc</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
    <span class=n>kernel</span><span class=o>::</span><span class=n>print_kernel</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=mf>2.2</span><span class=p>);</span>
    <span class=k>auto</span> <span class=n>n_inst</span> <span class=o>=</span> <span class=n>kernel</span><span class=o>::</span><span class=n>n_instructions</span><span class=p>(</span><span class=n>q</span><span class=p>,</span> <span class=mf>2.2</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td><td><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=nd>@qjit</span>
<span class=k>def</span> <span class=nf>kernel</span><span class=p>(</span><span class=n>q</span> <span class=p>:</span> <span class=n>qreg</span><span class=p>,</span> <span class=n>x</span> <span class=p>:</span> <span class=nb>float</span><span class=p>):</span>
    <span class=n>X</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
    <span class=n>Ry</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>x</span><span class=p>)</span>
    <span class=n>CX</span><span class=p>(</span><span class=n>q</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>q</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>

<span class=n>q</span> <span class=o>=</span> <span class=n>qalloc</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=n>kernel</span><span class=o>.</span><span class=n>print_kernel</span><span class=p>(</span><span class=n>q</span><span class=p>,</span> <span class=mf>2.2</span><span class=p>)</span>
<span class=n>n_inst</span> <span class=o>=</span> <span class=n>kernel</span><span class=o>.</span><span class=n>n_instructions</span><span class=p>(</span><span class=n>q</span><span class=p>,</span> <span class=mf>2.2</span><span class=p>)</span>

</code></pre></div></td></tr></table><p>Now we will&mldr;</p><h2 id=xasm>XASM&nbsp;<a class=headline-hash href=#xasm>¶</a></h2><h2 id=openqasm>OpenQasm&nbsp;<a class=headline-hash href=#openqasm>¶</a></h2><h2 id=unitary-matrix>Unitary Matrix&nbsp;<a class=headline-hash href=#unitary-matrix>¶</a></h2><h2 id=python>Python&nbsp;<a class=headline-hash href=#python>¶</a></h2><div class=edit-meta><br><a href=https://github.com/aide-qc/deploy//edit/master/website/content/users/quantum_kernels.md class=edit-page><i class="fas fa-pen-square"></i>Edit on GitHub</a></div><nav class=pagination><a class="nav nav-prev" href=/deploy/users/qjit/ title="Quantum JIT (QJIT)"><i class="fas fa-arrow-left" aria-hidden=true></i>Prev - Quantum JIT (QJIT)</a>
<a class="nav nav-next" href=/deploy/users/remote_qpu_creds/ title="Remote QPU Credentials">Next - Remote QPU Credentials <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=slide-menu><ul><li><a href=https://aide-qc.github.io/deploy>Home</a></li><li class=has-sub-menu><a href=/deploy/background/>Background<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=/deploy/background/qcor/>QCOR C++ Compiler and JIT Engine</a></li><li><a href=/deploy/background/xacc/>XACC Quantum Programming Framework</a></li><li><a href=/deploy/background/project/></a></li></ul></li><li class=has-sub-menu><a href=/deploy/developers/>Developer Guide<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=/deploy/developers/implement_optimizer/>Implement a new Optimizer</a></li><li><a href=/deploy/developers/clang_syntax/>QCOR Clang Syntax Handler</a></li></ul></li><li class=has-sub-menu><a href=/deploy/getting_started/>Getting Started<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=/deploy/getting_started/Faq/>Frequently Asked Questions</a></li><li><a href=/deploy/getting_started/build_from_source/>Build Everything from Source</a></li></ul></li><li class="parent has-sub-menu"><a href=/deploy/users/>User Guide<span class="mark opened">-</span></a><ul class=sub-menu><li><a href=/deploy/users/hello_world/>Hello World</a></li><li><a href=/deploy/users/pass_manager/>Pass Manager</a></li><li><a href=/deploy/users/qjit/>Quantum JIT (QJIT)</a></li><li class=active><a href=/deploy/users/quantum_kernels/>Quantum Kernels</a></li><li><a href=/deploy/users/remote_qpu_creds/>Remote QPU Credentials</a></li><li><a href=/deploy/users/tnqvm/>Tensor Network Quantum Virtual Machine</a></li><li><a href=/deploy/users/using_optimizer/>Using an Optimizer</a></li></ul></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i><i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>